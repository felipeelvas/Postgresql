FOREIGN KEY

Adicione uma restrição de chave estrangeira a uma tabela existente
Para adicionar uma restrição de chave estrangeira à tabela existente,
 use o seguinte formato da instrução ALTER TABLE :

ALTER TABLE child_table 
ADD CONSTRAINT constraint_name 
FOREIGN KEY (fk_columns) 
REFERENCES parent_table (parent_key_columns);

Linguagem de código:  SQL (linguagem de consulta estruturada)  ( sql )
Ao adicionar uma restrição de chave estrangeira com ON DELETE CASCADE
opção a uma tabela existente, você precisa seguir estas etapas:

Primeiro, elimine as restrições de chave estrangeira existentes:

ALTER TABLE child_table
DROP CONSTRAINT constraint_fkey;
Linguagem de código:  SQL (linguagem de consulta estruturada)  ( sql )
Primeiro, adicione uma nova restrição de chave estrangeira com   ON DELETE CASCADE ação:

ALTER TABLE child_table
ADD CONSTRAINT constraint_fk
FOREIGN KEY (fk_columns)
REFERENCES parent_table(parent_key_columns)
ON DELETE CASCADE;
Linguagem de código:  SQL (linguagem de consulta estruturada)  ( sql )
Neste tutorial, você aprendeu sobre chaves estrangeiras do PostgreSQL e como usar 
a restrição de chave estrangeira para criar chaves estrangeiras para uma tabela.
-- adicionar uma coluna id integer
-- tem que preencher essa coluna 1..
-- remove a primary antiga - film_id
-- transformar em primary key o id

postgres=# ALTER TABLE film_actor 
ADD PRIMARY KEY (id);
ALTER TABLE
postgres=# \d film_actor
                                                  Table "public.film_actor"
         Column          |            Type             | Collation | Nullable |                   Default                    
-------------------------+-----------------------------+-----------+----------+----------------------------------------------
 actor_id                | integer                     |           | not null | nextval('film_actor_actor_id_seq'::regclass)
 film_id                 | integer                     |           | not null | nextval('film_actor_film_id_seq'::regclass)
 data_ultima_atualizacao | timestamp without time zone |           | not null | 
 id                      | integer                     |           | not null | nextval('film_actor_columnid_seq'::regclass)
Indexes:
    "film_actor_pkey" PRIMARY KEY, btree (id)

postgres=# 
ALTER TABLE filme_categoria
ADD CONSTRAINT fk_filme_categoria_film_id
FOREIGN KEY (film_id) REFERENCES filme(film_id);

ALTER TABLE film_categoria
ADD CONSTRAINT fk_film_categoria_film_id 
FOREIGN KEY (film_id) REFERENCES filme(film_id);

ALTER TABLE film_actor    
ADD CONSTRAINT fk_film_actor_actor_id 
FOREIGN KEY (actor_id) REFERENCES actor(actor_id);

ALTER TABLE film_actor 
ALTER COLUMN actor_id TYPE SERIAL;

ALTER TABLE film_actor 
ALTER COLUMN actor_id TYPE int;
ALTER TABLE

postgres=# ALTER TABLE film_actor 
ALTER COLUMN film_id TYPE int;
ALTER TABLE

